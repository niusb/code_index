#### 重量级、轻量级区分

重量级：需要操作系统帮忙协调调度

轻量级：不需要操作系统协调，自己可以完成调度



#### 线程的三个特性

可见性、有序性、原子性

#### synchronized

**本质**：在对象头做改动相当于锁定

![image-20220828232158742](https://raw.githubusercontent.com/niusb/picGo/main/img/image-20220828232158742.png)

#### 重量级锁、轻量级锁

轻量级锁:自旋锁、乐观锁、无锁

#### 为什么会发生原子性的问题？

因为CPU 有时间片的概念，会根据不同的调度算法进行线程调度。当一个线程获得时间片之后开始执行，在时间片耗尽之后，就会失去 CPU 使用权。所以在多线程场景下，由于时间片在线程间轮换，就会发生原子性问题。

#### 如何解决原子性的问题呢？加锁，为什么加锁可以解决原子性问题？

Synchronized是 Java 在语言层面提供的互斥原语，Java中还有其他类型的锁。但是作为互斥锁，原理都是一样的，首先要有一个锁，然后是要锁住什么资源以及在哪里加锁

#### 为什么会发生有序性的问题?重排，sync有加内存屏障吗？

**指令重排序**

编译器或者解释器为了优化程序的执行性能，有时会改变程序的执行顺序。但是，编译器或者解释器对程序的执行顺序进行修改，

导致并发编程产生各种诡异问题的根源有三个：缓存导致的可见性问题、线程切换导致的原子性问题和编译优化带来的有序性问题。